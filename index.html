<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Schweizer Gesundheits-Jobs – Favoriten &amp; Tooltips</title>
  <style>
    :root{--bg:#f6f9fc;--card:#ffffffdd;--text:#16212d;--accent:#0b83d9;--muted:#64748b;}
    body.dark{--bg:#1b1e23;--card:#24272dcc;--text:#e8eaee;--accent:#46a0ff;--muted:#8c9bab;}
    body{margin:0;font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial,sans-serif;
         background:var(--bg);color:var(--text);transition:.3s background,.3s color;}
    header{padding:2rem 1rem 1rem;text-align:center;
           background:linear-gradient(120deg,var(--accent),#4bc4ff);color:#fff;position:relative;}
    h1{margin:0;font-size:clamp(1.6rem,4vw,2.6rem);}
    header p{opacity:.85;margin:.4rem 0;font-size:.9rem;}
    #toggle{position:absolute;top:1.2rem;right:1.2rem;width:44px;height:44px;opacity:0;cursor:pointer;}
    #toggle+label{position:absolute;top:1.2rem;right:1.2rem;width:44px;height:44px;border-radius:50%;
                 background:rgba(255,255,255,.25);backdrop-filter:blur(4px);
                 display:flex;align-items:center;justify-content:center;transition:.4s;}
    #toggle+label svg{fill:#fff;width:24px;height:24px;} #toggle:checked+label{transform:rotate(180deg);}
    main{max-width:960px;margin:-3rem auto 3rem;padding:0 1rem;}
    section.card{background:var(--card);border-radius:1rem;padding:1rem 1.25rem;margin-top:2rem;
                 box-shadow:0 4px 12px rgba(0,0,0,.08);backdrop-filter:blur(6px);}
    details{border-bottom:1px solid rgba(0,0,0,.05);} details:last-child{border:none;}
    summary{cursor:pointer;font-size:1.1rem;padding:.7rem 0;list-style:none;position:relative;}
    summary::after{content:'';position:absolute;right:0;top:50%;
                   width:.55rem;height:.55rem;border:2px solid var(--accent);
                   border-left:none;border-top:none;transform:translateY(-50%) rotate(45deg);transition:.35s;}
    details[open] summary::after{transform:translateY(-50%) rotate(-135deg);}
    ul.links{list-style:none;margin:0 0 1rem;padding-left:0;display:flex;flex-direction:column;gap:.45rem;}
    li.item{display:flex;align-items:center;gap:.6rem;position:relative;}
    a{color:var(--accent);text-decoration:none;font-weight:500;} a:hover{text-decoration:underline;}
    .star{font-size:1.15rem;cursor:pointer;color:var(--muted);user-select:none;transition:.2s;}
    .star.fav{color:var(--accent);}
    /* Tooltip */
    .tooltip{position:absolute;z-index:50;max-width:300px;background:var(--card);color:var(--text);
             border-radius:.9rem;box-shadow:0 4px 14px rgba(0,0,0,.12);padding:1rem;font-size:.9rem;
             line-height:1.4;display:none;flex-direction:column;gap:.45rem;}
    .tooltip h3{margin:.1rem 0 .5rem;font-size:.95rem;font-weight:600;color:var(--accent);}
    .tooltip ul{margin:.25rem 0 0 1rem;padding:0;} .tooltip ul li{list-style:disc;margin:.2rem 0;}
    footer{text-align:center;font-size:.85rem;color:var(--muted);margin-top:3rem;}
  </style>
</head>
<body>
  <input type="checkbox" id="toggle" aria-label="Farbschema wechseln">
  <label for="toggle"><svg viewBox="0 0 24 24"><path d="M12 2a1 1 0 0 1 1 1v1.07a8 8 0 0 1 8 8h1.07a1 1 0 0 1 0 2H21a8 8 0 0 1-8 8v1.07a1 1 0 0 1-2 0V21a8 8 0 0 1-8-8H2.93a1 1 0 0 1 0-2H3a8 8 0 0 1 8-8V3a1 1 0 0 1 1-1z"/></svg></label>

  <header>
    <h1>Job-Links im Schweizer Gesundheits-Ökosystem</h1>
    <p>Favoriten per ⭐ speichern – Tooltips nur für BAG &amp; USZ</p>
  </header>

  <main>
    <!-- Favoriten -->
    <section class="card" id="fav-sec" style="display:none;">
      <details open><summary>⭐ Meine Favoriten</summary>
        <ul class="links" id="fav-list"></ul>
      </details>
    </section>

    <!-- Bund / Bundesnahe -->
    <section class="card"><details>
      <summary>Bund / bundesnahe Institutionen</summary>
      <ul class="links">
        <li class="item" data-id="bag" data-link="https://www.bag.admin.ch/bag/de/home/das-bag/arbeiten-im-bag/offene-stellen.html" data-desc="Das Bundesamt für Gesundheit (BAG) verantwortet nationale Gesundheitspolitik und Prävention.">
          <span class="star">☆</span><a href="https://www.bag.admin.ch/bag/de/home/das-bag/arbeiten-im-bag/offene-stellen.html" target="_blank">Bundesamt für Gesundheit (BAG)</a>
        </li>
        <li class="item" data-id="bsv" data-link="https://www.bsv.admin.ch/bsv/de/home/bsv/arbeitenimbsv.html" data-desc="Das Bundesamt für Sozialversicherungen (BSV) gestaltet und überwacht AHV, IV, EL, BVG usw.">
          <span class="star">☆</span><a href="https://www.bsv.admin.ch/bsv/de/home/bsv/arbeitenimbsv.html" target="_blank">Bundesamt für Sozialversicherungen (BSV)</a>
        </li>
        <!-- weitere Bundeseinträge... -->
      </ul>
    </details></section>

    <!-- Kantone -->
    <!-- vollständige Liste analog vorher einfügen -->

    <!-- Versicherungen -->
    <!-- ... -->

    <!-- Leistungserbringer -->
    <!-- ... -->

    <!-- Beratung / Forschung -->
    <!-- ... -->

    <!-- Stiftungen -->
    <!-- ... -->
  </main>

  <footer>Favoriten bleiben nur in diesem Browser gespeichert – alle Links ohne Gewähr</footer>

  <div id="tooltip" class="tooltip" role="dialog" aria-live="polite"></div>

  <script>
    // Dark-Mode Persistenz
    const dmToggle = document.getElementById('toggle');
    dmToggle.checked = localStorage.getItem('darkMode')==='1';
    document.body.classList.toggle('dark', dmToggle.checked);
    dmToggle.addEventListener('change', ()=>{
      localStorage.setItem('darkMode', dmToggle.checked?'1':'0');
      document.body.classList.toggle('dark', dmToggle.checked);
    });

    // Favoriten (localStorage)
    const LSKEY = 'favJobs';
    const favList = document.getElementById('fav-list');
    const favSec = document.getElementById('fav-sec');
    const getFavs = ()=> JSON.parse(localStorage.getItem(LSKEY) || '[]');
    const setFavs = ids => localStorage.setItem(LSKEY, JSON.stringify(ids));

    function renderFav() {
      const ids = getFavs();
      favSec.style.display = ids.length ? '' : 'none';
      favList.innerHTML = '';
      ids.forEach(id=>{
        const src = document.querySelector(`.item[data-id="${id}"]`);
        if(src) favList.appendChild(src.cloneNode(true));
      });
      document.querySelectorAll('.item').forEach(li=>{
        const star=li.querySelector('.star');
        star.classList.toggle('fav', ids.includes(li.dataset.id));
      });
    }
    document.addEventListener('DOMContentLoaded', renderFav);

    document.addEventListener('click', e=>{
      if(e.target.matches('.star')){
        const li = e.target.closest('.item');
        const id = li.dataset.id;
        let ids = getFavs();
        ids = ids.includes(id) ? ids.filter(x=>x!==id) : [...ids,id];
        setFavs(ids);
        renderFav();
      }
    });

    // Tooltip für BAG & USZ
    let JOB_DATA = {};
    fetch('jobs-data.json').then(r=>r.json()).then(json=>JOB_DATA=json);

    const tooltip = document.getElementById('tooltip');
    let hideTimeout;

    function positionTooltip(e) {
      const r = tooltip.getBoundingClientRect();
      let x = e.pageX + 15, y = e.pageY + 15;
      if(x + r.width > window.innerWidth) x = window.innerWidth - r.width - 12;
      if(y + r.height > window.innerHeight) y = e.pageY - r.height - 15;
      tooltip.style.left = x + 'px'; tooltip.style.top = y + 'px';
    }

    function buildJobs(id) {
      const jobs = JOB_DATA[id] || [];
      if(!jobs.length) return '<em>Keine aktuellen Stellen</em>';
      return '<ul>' + jobs.map(j=>`<li><a href="${j.url}" target="_blank">${j.title}</a><br><small>${j.location} · ${j.pensum}</small></li>`).join('') + '</ul>';
    }

    function showTooltip(li, e) {
      const id = li.dataset.id;
      if(id !== 'bag' && id !== 'usz') return;
      clearTimeout(hideTimeout);
      tooltip.innerHTML = `<h3>${li.querySelector('a').textContent}</h3><p>${li.dataset.desc}</p>${buildJobs(id)}`;
      tooltip.style.display = 'flex';
      positionTooltip(e);
    }

    function hideTooltip() {
      hideTimeout = setTimeout(()=> tooltip.style.display = 'none', 180);
    }

    document.addEventListener('mouseover', e=>{
      const li = e.target.closest('.item');
      if(li) showTooltip(li, e);
    });
    document.addEventListener('mouseout', e=>{
      const to = e.relatedTarget;
      if(!to || (!to.closest('.item') && !to.closest('.tooltip'))) hideTooltip();
    });
    tooltip.addEventListener('mouseover', ()=> clearTimeout(hideTimeout));
    tooltip.addEventListener('mouseout', hideTooltip);
  </script>
</body>
</html>
